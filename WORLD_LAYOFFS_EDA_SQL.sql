--- EXPLORATORY DATA ANALYSIS

SELECT *
FROM layoffs_stagging;

--- TOTAL EMPLOYEE TERMINATED BASED ON COMPANY

SELECT company,sum(TOTAL_LAID_OFF)
FROM layoffs_stagging
GROUP BY company
ORDER BY sum(TOTAL_LAID_OFF) DESC;

--- TO CHECK MINIMUM AND MAXIMUM DATE OF LAIDOFF

SELECT MIN(DATE),MAX(DATE)
FROM layoffs_stagging;

--- MOST OF EMPLOYEE GOT TERMINATED IN 2022 DUE TO COVID

SELECT YEAR(DATE),sum(TOTAL_LAID_OFF)
FROM layoffs_stagging
GROUP BY YEAR(DATE)
ORDER BY 2 DESC;

SELECT *
FROM layoffs_stagging;

--- FROM BELOW WE CAN SAY MAXIMUM EMPLOYEE TERMINATED BY United States AND THEN INDIA

SELECT COUNTRY,sum(TOTAL_LAID_OFF)
FROM layoffs_stagging
GROUP BY COUNTRY
ORDER BY sum(TOTAL_LAID_OFF) DESC;

--- FROM CONSUMER INDUSTRY MAXIMUM EMPLOYEE TERMINATED

SELECT industry,sum(TOTAL_LAID_OFF)
FROM layoffs_stagging
GROUP BY industry
ORDER BY sum(TOTAL_LAID_OFF) DESC;

SELECT substring(DATE,1,7) AS MONTH ,sum(TOTAL_LAID_OFF)
FROM layoffs_stagging
WHERE substring(DATE,6,2) IS NOT NULL
GROUP BY MONTH
ORDER BY 1 ;

WITH CUMULATIVE_SUM AS
(
SELECT substring(DATE,1,7) AS MONTH ,sum(TOTAL_LAID_OFF) AS TOTAL_OFF
FROM layoffs_stagging
WHERE substring(DATE,1,7) IS NOT NULL
GROUP BY MONTH
ORDER BY 1 
)

SELECT MONTH,TOTAL_OFF,SUM(TOTAL_OFF) OVER(ORDER BY MONTH) AS CUMULATIVE_TOTAL
FROM CUMULATIVE_SUM;

SELECT COMPANY,YEAR(DATE),SUM(TOTAL_LAID_OFF)
FROM layoffs_stagging
GROUP BY COMPANY,YEAR(DATE)
ORDER BY SUM(TOTAL_LAID_OFF) DESC;


WITH COMPANY_YEAR(COMPANY,YEAR,TOTAL_LAID_OFF) AS
(
SELECT COMPANY,YEAR(DATE),SUM(TOTAL_LAID_OFF)
FROM layoffs_stagging
GROUP BY COMPANY,YEAR(DATE)
),
COMPANY_YEAR_RANKING AS(
SELECT *,DENSE_RANK()OVER(PARTITION BY YEAR ORDER BY TOTAL_LAID_OFF DESC) AS RANKING
FROM COMPANY_YEAR
WHERE YEAR IS NOT NULL
)

SELECT *
FROM COMPANY_YEAR_RANKING
WHERE RANKING<=5
ORDER BY RANKING;

























































